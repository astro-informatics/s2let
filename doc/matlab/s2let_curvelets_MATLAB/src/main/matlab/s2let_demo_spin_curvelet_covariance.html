<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of s2let_demo_spin_curvelet_covariance</title>
  <meta name="keywords" content="s2let_demo_spin_curvelet_covariance">
  <meta name="description" content="s2let_demo_spin_curvelet_covariance">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">s2let_curvelets_MATLAB</a> &gt; <a href="#">src</a> &gt; <a href="#">main</a> &gt; <a href="index.html">matlab</a> &gt; s2let_demo_spin_curvelet_covariance.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for s2let_curvelets_MATLAB/src/main/matlab&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>s2let_demo_spin_curvelet_covariance
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>s2let_demo_spin_curvelet_covariance</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> s2let_demo_spin_curvelet_covariance 
 - Run curvelet covariance demo.

 Demo to compare theoretical covariance of curvelet coefficients with
 empirical data from using our transform functions. 
 The empirical covariance is computed for several sets of 
 harmonic coefficients,
 and the theoretical covariance is compared to the mean of those
 calculations in units of its standard deviation. 

 Default usage is given by

   s2let_demo_curvelet_covariance
 
 Authors: Martin Büttner (m.buettner.d@gmail.com)
          Jason McEwen (www.jasonmcewen.org)
          Jennifer Y. H. Chan (jennifercyh@gmail.com)
 ---------------------------------------------------------
 S2LET package to perform wavelet transforms on the sphere.
 Copyright (C) 2012-2014 Boris Leistedt and Jason McEwen
 See LICENSE.txt for license details
 
 Modified S2LET package to perform curvelet transforms on the Sphere.
 ---------------------------------------------------------</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="s2let_jmax.html" class="code" title="function J = s2let_jmax(L, B)">s2let_jmax</a>	s2let_jmax</li><li><a href="s2let_spin_curvelet_tiling.html" class="code" title="function  [cur_lm scal_l] = s2let_spin_curvelet_tiling(B, L, J_min, varargin)">s2let_spin_curvelet_tiling</a>	</li><li><a href="s2let_transform_curvelet_analysis_px2cur.html" class="code" title="function [f_cur, f_scal] = s2let_transform_curvelet_analysis_px2cur(f_init, varargin)">s2let_transform_curvelet_analysis_px2cur</a>	s2let_transform_curvelet_analysis_px2cur</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% s2let_demo_spin_curvelet_covariance</span>
0002 <span class="comment">% - Run curvelet covariance demo.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Demo to compare theoretical covariance of curvelet coefficients with</span>
0005 <span class="comment">% empirical data from using our transform functions.</span>
0006 <span class="comment">% The empirical covariance is computed for several sets of</span>
0007 <span class="comment">% harmonic coefficients,</span>
0008 <span class="comment">% and the theoretical covariance is compared to the mean of those</span>
0009 <span class="comment">% calculations in units of its standard deviation.</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% Default usage is given by</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%   s2let_demo_curvelet_covariance</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% Authors: Martin Büttner (m.buettner.d@gmail.com)</span>
0016 <span class="comment">%          Jason McEwen (www.jasonmcewen.org)</span>
0017 <span class="comment">%          Jennifer Y. H. Chan (jennifercyh@gmail.com)</span>
0018 <span class="comment">% ---------------------------------------------------------</span>
0019 <span class="comment">% S2LET package to perform wavelet transforms on the sphere.</span>
0020 <span class="comment">% Copyright (C) 2012-2014 Boris Leistedt and Jason McEwen</span>
0021 <span class="comment">% See LICENSE.txt for license details</span>
0022 <span class="comment">%</span>
0023 <span class="comment">% Modified S2LET package to perform curvelet transforms on the Sphere.</span>
0024 <span class="comment">% ---------------------------------------------------------</span>
0025 clear all;
0026 
0027 <span class="comment">% Define parameters</span>
0028 B = 2;
0029 L = 16;
0030 N = L;
0031 Spin = 0;
0032 J_min = 2;
0033 J = <a href="s2let_jmax.html" class="code" title="function J = s2let_jmax(L, B)">s2let_jmax</a>(L, B);
0034 
0035 var_flm = 1; <span class="comment">% Should we use the actual variance var(flmn) of each</span>
0036              <span class="comment">% realization here instead?</span>
0037 
0038 <span class="comment">% Compute theoretical covariance of curvelet coefficients.</span>
0039 <span class="comment">% The covariance &lt;Wj(rho)Wj*(rho)&gt; is given by the following expression:</span>
0040 <span class="comment">%</span>
0041 <span class="comment">% sigma^2 Sum(l,n) |Psij_ln|^2</span>
0042 <span class="comment">%</span>
0043 <span class="comment">% Where sigma^2 is the variance of the harmonic coefficients and Psij_lm</span>
0044 <span class="comment">% are the harmonic coefficients of the j-th curvelet.</span>
0045 <span class="comment">%</span>
0046 <span class="comment">% A similar expression applies for the scaling function coefficients.</span>
0047 
0048 
0049 <span class="comment">% ---------------</span>
0050 <span class="comment">% Tile curvelets:</span>
0051 <span class="comment">% ---------------</span>
0052 [cur_lm scal_l] = <a href="s2let_spin_curvelet_tiling.html" class="code" title="function  [cur_lm scal_l] = s2let_spin_curvelet_tiling(B, L, J_min, varargin)">s2let_spin_curvelet_tiling</a>(B, L, J_min, <span class="keyword">...</span>
0053                                         <span class="string">'Spin'</span>, Spin, <span class="string">'SpinLowered'</span>, false,<span class="keyword">...</span>
0054                                         <span class="string">'SpinLoweredFrom'</span>,0);
0055 <span class="comment">% reshape scaling functions</span>
0056 kappa0_cur = zeros(L,1);
0057 <span class="keyword">for</span> el = abs(Spin):L-1
0058  kappa0_cur(el+1,1) = scal_l(el^2+el+1,1);
0059 <span class="keyword">end</span>
0060 <span class="comment">% reshape curvelets</span>
0061 kappa_cur = zeros(J+1,L^2);
0062 <span class="keyword">for</span> j = J_min:J
0063  ind = Spin*Spin + 1;
0064  <span class="keyword">for</span> el = abs(Spin):L-1
0065   <span class="keyword">for</span> m= -el:el
0066    kappa_cur(j+1,ind) = cur_lm{j-J_min+1}(1,ind);
0067    ind = ind +1; 
0068   <span class="keyword">end</span>
0069  <span class="keyword">end</span>
0070 <span class="keyword">end</span> 
0071 
0072 
0073 covar_W_phi_theory = 0;
0074 <span class="keyword">for</span> el = 0:L-1
0075     covar_W_phi_theory = covar_W_phi_theory + kappa0_cur(el+1) * kappa0_cur(el+1)';
0076 <span class="keyword">end</span>
0077 
0078 covar_W_psi_theory = zeros(J-J_min+1,1);
0079 <span class="keyword">for</span> j = J_min:J
0080     ind = 1;
0081     <span class="keyword">for</span> el = 0:L-1
0082         <span class="keyword">for</span> n = -el:el
0083             covar_W_psi_theory(j-J_min+1) = covar_W_psi_theory(j-J_min+1) + kappa_cur(j+1,ind) * kappa_cur(j+1,ind)';
0084             ind = ind + 1;
0085         <span class="keyword">end</span>
0086     <span class="keyword">end</span>
0087 <span class="keyword">end</span>
0088 
0089 covar_W_phi_theory = covar_W_phi_theory .* var_flm
0090 covar_W_psi_theory = covar_W_psi_theory .* var_flm
0091 
0092 runs = 100;
0093 <span class="keyword">if</span> J_min == 0
0094     <span class="comment">% Ergodicity fails for J_min = 0, because the scaling function will</span>
0095     <span class="comment">% only cover f00. Hence &lt;flm flm*&gt; will be 0 in that case and the</span>
0096     <span class="comment">% scaling coefficients will all be the same. So, if we do have</span>
0097     <span class="comment">% J_min = 0, we take the variance over all realisations instead (of</span>
0098     <span class="comment">% course, we then won't have a standard deviation to compare it to the</span>
0099     <span class="comment">% theoretical variance).</span>
0100     f_scals = zeros(runs,1);
0101 <span class="keyword">else</span>
0102     covar_W_phi_data = zeros(1, runs);
0103 <span class="keyword">end</span>
0104 
0105 covar_W_psi_data = zeros(J-J_min+1, runs);
0106 
0107 
0108 <span class="keyword">for</span> i = 1:runs
0109     <span class="comment">% Generate normally distributed random flmn of complex signal</span>
0110     <span class="comment">% with mean 0 and variance 1</span>
0111     flm = zeros(L^2 - Spin^2, 1);
0112     flm = [zeros(Spin^2,1); (randn(size(flm)) + 1i*randn(size(flm)))/sqrt(2)*sqrt(var_flm)];
0113 
0114     <span class="comment">% Compute inverse then forward transform.</span>
0115     f = ssht_inverse(flm, L, <span class="string">'Spin'</span>, Spin);
0116 
0117     
0118     <span class="comment">% ---------------</span>
0119     <span class="comment">% Curvelet transform:</span>
0120     <span class="comment">% ---------------</span>
0121     [f_cur, f_scal] = <a href="s2let_transform_curvelet_analysis_px2cur.html" class="code" title="function [f_cur, f_scal] = s2let_transform_curvelet_analysis_px2cur(f_init, varargin)">s2let_transform_curvelet_analysis_px2cur</a>(complex(real(f), imag(f)), <span class="keyword">...</span>
0122                                                                <span class="string">'B'</span>, B, <span class="string">'L'</span>, L,  <span class="string">'J_min'</span>, J_min,  <span class="keyword">...</span>
0123                                                                <span class="string">'Spin'</span>, Spin,  <span class="keyword">...</span>
0124                                                                <span class="string">'Reality'</span>, false, <span class="keyword">...</span>
0125                                                                <span class="string">'Upsample'</span>, true, <span class="keyword">...</span>
0126                                                                <span class="string">'SpinLowered'</span>, false,<span class="keyword">...</span>
0127                                                                <span class="string">'SpinLoweredFrom'</span>,0, <span class="keyword">...</span>
0128                                                                <span class="string">'Sampling'</span>,<span class="string">'MW'</span>);
0129 
0130     <span class="keyword">if</span> J_min == 0
0131         f_scals(i) = f_scal(1);
0132     <span class="keyword">else</span>
0133         covar_W_phi_data(i) = var(f_scal(:));
0134     <span class="keyword">end</span>
0135 
0136     <span class="keyword">for</span> j = J_min:J
0137         f_cur_j = f_cur{j-J_min+1};
0138         covar_W_psi_data(j-J_min+1,i) = var(f_cur_j(:));
0139     <span class="keyword">end</span>
0140 <span class="keyword">end</span>
0141 
0142 <span class="keyword">if</span> J_min == 0
0143     covar_W_phi_data = var(f_scals(:))
0144     W_phi_error_absolute = abs(covar_W_phi_data - covar_W_phi_theory)
0145 <span class="keyword">else</span>
0146     mean_covar_W_phi_data = mean(covar_W_phi_data)
0147     std_covar_W_phi_data = std(covar_W_phi_data)
0148     W_phi_error_in_std = abs(mean_covar_W_phi_data - covar_W_phi_theory)/std_covar_W_phi_data
0149 <span class="keyword">end</span>
0150 
0151 mean_covar_W_psi_data = mean(covar_W_psi_data,2)
0152 std_covar_W_psi_data = std(covar_W_psi_data,0,2)
0153 W_psi_error_in_std = abs(mean_covar_W_psi_data - covar_W_psi_theory)./std_covar_W_psi_data</pre></div>
<hr><address>Generated on Tue 16-Jun-2015 21:37:37 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>