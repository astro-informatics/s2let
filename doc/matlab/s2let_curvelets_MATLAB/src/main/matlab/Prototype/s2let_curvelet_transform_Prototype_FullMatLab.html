<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of s2let_curvelet_transform_Prototype_FullMatLab</title>
  <meta name="keywords" content="s2let_curvelet_transform_Prototype_FullMatLab">
  <meta name="description" content="s2let_curvelet_transform_via_lmn2lm_randflm_MATLAB">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../../index.html">Home</a> &gt;  <a href="../../../../index.html">s2let_curvelets_MATLAB</a> &gt; <a href="#">src</a> &gt; <a href="#">main</a> &gt; <a href="../index.html">matlab</a> &gt; <a href="index.html">Prototype</a> &gt; s2let_curvelet_transform_Prototype_FullMatLab.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../../index.html"><img alt="<" border="0" src="../../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for s2let_curvelets_MATLAB/src/main/matlab/Prototype&nbsp;<img alt=">" border="0" src="../../../../../right.png"></a></td></tr></table>-->

<h1>s2let_curvelet_transform_Prototype_FullMatLab
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="box"><strong>s2let_curvelet_transform_via_lmn2lm_randflm_MATLAB</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> s2let_curvelet_transform_via_lmn2lm_randflm_MATLAB
 Run curvelet analysis and synthesis 
 of randomly generated signals f</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% s2let_curvelet_transform_via_lmn2lm_randflm_MATLAB</span>
0002 <span class="comment">% Run curvelet analysis and synthesis</span>
0003 <span class="comment">% of randomly generated signals f</span>
0004 
0005 clear all;
0006 close all;
0007 
0008 <span class="comment">% Main parameters</span>
0009 Spin = 0;
0010 L = 16;
0011 N = L; <span class="comment">% For curvelets: N=L  %N=1 for axisymmetric curvelets</span>
0012 B = 2;
0013 J_min = 1;  <span class="comment">%N.B. J_min = 2 : NOT EXACT</span>
0014 J =s2let_jmax(L, B);  <span class="comment">%=ceil(log L/ log B);</span>
0015 
0016 <span class="comment">%{</span>
0017 disp(<span class="string">'Generates random band-limited function'</span>)
0018 flm_init = zeros(L^2,1);
0019 flm_init = rand(size(flm_init)) + sqrt(-1)*rand(size(flm_init));
0020 flm_init = 2.*(flm_init - (1+sqrt(-1))./2);
0021 
0022 disp(<span class="string">'Construct the corresponding signal on the sphere'</span>)
0023 f_init = ssht_inverse(flm_init, L, <span class="string">'Method'</span>, <span class="string">'MW'</span>);
0024 <span class="comment">%}</span>
0025 
0026 flm_init = zeros(L^2,1);
0027 <span class="comment">%</span>
0028 disp(<span class="string">'read from file flm_init'</span>); 
0029 fid= fopen(<span class="string">'/Users/jenniferyhchan/WaveletsCode_PhD/s2let_curvelets_MATLAB/1_cur_flm_randgen_mw_test.dat'</span>);
0030 rawData=fscanf(fid, <span class="string">'%f, %f'</span>,[2 256]);
0031 fclose(fid);
0032 complexData=complex(rawData(1,:),rawData(2,:));
0033 flm_init= complexData.' ;  <span class="comment">% Non-conjugate transpose</span>
0034 <span class="comment">%</span>
0035 disp(<span class="string">'Construct the corresponding signal via ssht_inverse'</span>); 
0036 f_init = ssht_inverse(flm_init, L, <span class="string">'Method'</span>, <span class="string">'MW'</span>);
0037 <span class="comment">%</span>
0038 disp(<span class="string">'Construct the corresponding flm of the signal via ssht_forward'</span>); 
0039 flm_init= ssht_forward(f_init, L, <span class="string">'Method'</span>, <span class="string">'MW'</span>);
0040 
0041 <span class="comment">% ---------------</span>
0042 <span class="comment">% Tile curvelets:</span>
0043 <span class="comment">% ---------------</span>
0044 <span class="comment">% Call curvelet- and scaling-function- generating functions</span>
0045 disp(<span class="string">'curvelet_tiling: Tile curvelets in harmonic space (cur_lm, scal_l)'</span>)
0046 [cur_lm scal_l] = s2let_curvelet_tiling(B, L, J_min, <span class="keyword">...</span>
0047                                         <span class="string">'Spin'</span>, Spin, <span class="string">'SpinLowered'</span>, false,  <span class="string">'SpinLoweredFrom'</span>, 0);
0048 
0049 <span class="comment">% -----------------</span>
0050 <span class="comment">% Signal analysis: (harmonic to Wigner space)</span>
0051 <span class="comment">% -----------------</span>
0052 <span class="comment">%{</span>
0053 <span class="comment">% Call matlab function analysis_lm2lmn</span>
0054 [f_cur_lmn, f_scal_lm] = s2let_transform_analysis_lm2lmn(flm_init, cur_lm, scal_l, <span class="keyword">...</span>
0055                                                          <span class="string">'B'</span>, B, <span class="string">'L'</span>, L, <span class="string">'J_min'</span>, J_min,<span class="keyword">...</span>
0056                                                          <span class="string">'Spin'</span>, Spin,  <span class="string">'Reality'</span>, false, <span class="string">'Upsample'</span>, false,<span class="keyword">...</span>
0057                                                          <span class="string">'SpinLowered'</span>, false,  <span class="string">'SpinLoweredFrom'</span>, 0, <span class="keyword">...</span>
0058                                                          <span class="string">'Sampling'</span>, <span class="string">'MW'</span>);
0059 <span class="comment">%}</span>
0060 <span class="comment">%</span>
0061 <span class="comment">% Curvelet Contribution</span>
0062 <span class="comment">%</span>
0063 <span class="keyword">for</span> j = J_min:J,
0064  f_cur_lmn{j-J_min+1} = zeros((2*N-1)*L*L,1);
0065  ind_ln=0;
0066  ind = 0;
0067  ind_lmn = 0;
0068  <span class="keyword">for</span> n = -N+1:N-1,
0069     <span class="keyword">for</span> el = abs(n):L-1,
0070         ind_ln = ssht_elm2ind(el, n);
0071         psi = 8.*pi*pi/(2.*el+1) *conj(cur_lm{j-J_min+1}(ind_ln));
0072         <span class="keyword">for</span> m = -el:el,
0073         ind = ssht_elm2ind(el, m); 
0074         ind_lmn = so3_elmn2ind(el,m,n,L,N);
0075         f_cur_lmn{j-J_min+1}(ind_lmn) =  flm_init(ind) * psi;
0076         <span class="keyword">end</span>
0077     <span class="keyword">end</span>
0078  <span class="keyword">end</span>
0079 <span class="keyword">end</span>
0080 <span class="comment">%</span>
0081 <span class="comment">% Scaling function Contribution</span>
0082 <span class="comment">%</span>
0083 disp(<span class="string">'Compute scaling function f_scal_lm=flm_init(lm_ind) * phi '</span>)
0084 <span class="comment">%f_scal_lm = zeros(L^2,1)</span>
0085 lm_ind=0;
0086 <span class="keyword">for</span> el = 0:L-1,
0087  phi = sqrt(4.0*pi/(2.*el+1)) * scal_l(el^2+el+1,1);  <span class="comment">%</span>
0088  <span class="keyword">for</span> m = -el:el,
0089  lm_ind=ssht_elm2ind(el, m);
0090  f_scal_lm(lm_ind) = flm_init(lm_ind) * phi;
0091  <span class="keyword">end</span>
0092 <span class="keyword">end</span>
0093 
0094 
0095 <span class="comment">%</span>
0096 disp(<span class="string">'so3_inverse and so3_forward'</span>)
0097 <span class="comment">%</span>
0098 <span class="keyword">for</span> j = J_min:J,
0099 f_cur{j-J_min+1} = so3_inverse(f_cur_lmn{j-J_min+1}, L, N, <span class="string">'Sampling'</span>, <span class="string">'MW'</span>);
0100 f_cur_lmn{j-J_min+1} = so3_forward(f_cur{j-J_min+1}, L, N,<span class="string">'Sampling'</span>, <span class="string">'MW'</span>);
0101 <span class="keyword">end</span>  
0102 f_scal= ssht_inverse(f_scal_lm, L,<span class="string">'Method'</span>, <span class="string">'MW'</span>);
0103 f_scal_lm = ssht_forward(f_scal, L,<span class="string">'Method'</span>, <span class="string">'MW'</span>);
0104                                             
0105 <span class="comment">% -----------------</span>
0106 <span class="comment">% Signal synthesis: (Wigner to harmonic space)</span>
0107 <span class="comment">% -----------------</span>
0108 <span class="comment">%{</span>
0109 <span class="comment">% Call s2let_transform_synthesis_lmn2lm</span>
0110 [flm_cur_syn, flm_scal_syn] = s2let_transform_synthesis_lmn2lm(f_cur_lmn, f_scal_lm, <span class="keyword">...</span>
0111                                                                cur_lm, scal_l, flm_init, <span class="keyword">...</span>
0112                                                                <span class="string">'B'</span>, B, <span class="string">'L'</span>, L, <span class="string">'J_min'</span>, J_min,<span class="keyword">...</span>
0113                                                                <span class="string">'Spin'</span>, Spin,  <span class="string">'Reality'</span>, false, <span class="string">'Upsample'</span>, false,<span class="keyword">...</span>
0114                                                                <span class="string">'SpinLowered'</span>, false,  <span class="string">'SpinLoweredFrom'</span>, 0, <span class="keyword">...</span>
0115                                                                <span class="string">'Sampling'</span>, <span class="string">'MW'</span>);
0116 <span class="comment">%}</span>
0117 disp(<span class="string">'Signal synthesis: '</span>);
0118 disp(<span class="string">'Compute flm_cur_syn from f_cur_lmn'</span>);
0119 flm_cur_syn=zeros(L^2,1);
0120 <span class="keyword">for</span> j = J_min:J,
0121  ind_ln =0;
0122  ind=0;
0123  ind_lmn=0;
0124  <span class="keyword">for</span> en = -N+1:N-1,
0125     <span class="keyword">for</span> el = abs(en):L-1,
0126         ind_ln = ssht_elm2ind(el, en);
0127         psi = (cur_lm{j-J_min+1}(ind_ln));
0128         <span class="keyword">for</span> m = -el:el,
0129         ind = ssht_elm2ind(el, m);
0130         ind_lmn = so3_elmn2ind(el,m,en,L,N);
0131         flm_cur_syn(ind) =flm_cur_syn(ind)+ f_cur_lmn{j-J_min+1}(ind_lmn)* psi;
0132         <span class="keyword">end</span> 
0133     <span class="keyword">end</span>
0134  <span class="keyword">end</span>
0135 <span class="keyword">end</span>
0136 disp(<span class="string">'Compute flm_scal_syn '</span>)
0137 <span class="comment">%% For scaling function - sum over m:</span>
0138 flm_scal_syn=zeros(L^2,1);
0139 lm_ind=0;
0140  <span class="keyword">for</span> el = 0:L-1,
0141   phi = sqrt(4.*pi/(2.*el+1))*scal_l(el^2+el+1,1);
0142   <span class="keyword">for</span> m = -el:el, 
0143   lm_ind=ssht_elm2ind(el, m);
0144   flm_scal_syn(lm_ind) =  flm_scal_syn(lm_ind)+ f_scal_lm(lm_ind)* phi;
0145   <span class="keyword">end</span>
0146  <span class="keyword">end</span>
0147 <span class="comment">% f_scal_l=sum(flm_test_scal)</span>
0148 
0149 disp(<span class="string">'Sum: flm_cur_syn+flm_scal_syn '</span>);
0150 flm_rec = flm_scal_syn + flm_cur_syn;
0151 
0152                                        
0153 disp(<span class="string">'Compute the re-constructed function via ssht_inverse '</span>);
0154 f_rec = ssht_inverse(flm_rec, L, <span class="string">'Method'</span>, <span class="string">'MW'</span>); 
0155 
0156 disp(<span class="string">'Both analysis and synthesis are done! '</span>);
0157 disp(<span class="string">''</span>);
0158 disp(<span class="string">'- Test exact transform: check the difference between flm_init and flm_rec:'</span>);
0159 maxerr = max(abs(flm_init - flm_rec))
0160 disp(<span class="string">'Check the difference between f_init and f_rec: '</span>);
0161 maxerr = max(abs(f_init(:) - f_rec(:)))</pre></div>
<hr><address>Generated on Tue 16-Jun-2015 10:12:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>