<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of s2let_demo9_Spin_Curvelet_Mollweide_EarthTomography</title>
  <meta name="keywords" content="s2let_demo9_Spin_Curvelet_Mollweide_EarthTomography">
  <meta name="description" content="s2let_demo9_Spin_Curvelet_Mollweide_EarthTomography">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">s2let_curvelets_MATLAB</a> &gt; <a href="#">src</a> &gt; <a href="#">main</a> &gt; <a href="index.html">matlab</a> &gt; s2let_demo9_Spin_Curvelet_Mollweide_EarthTomography.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for s2let_curvelets_MATLAB/src/main/matlab&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>s2let_demo9_Spin_Curvelet_Mollweide_EarthTomography
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>s2let_demo9_Spin_Curvelet_Mollweide_EarthTomography</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> s2let_demo9_Spin_Curvelet_Mollweide_EarthTomography
 -----------------------------------------------------------
 Plot curvelet coefficients on multiple Mollweide projections.
 The function generates one plot of the scaling function
 contribution and a grid of plots for each orientation of
 each scale of the wavelet contributions. 
 -----------------------------------------------------------
 S2LET package to perform Wavelets on the Sphere.
 Copyright (C) 2012  Boris Leistedt &amp; Jason McEwen
 See LICENSE.txt for license details
 
 Modified S2LET package to perform Curvelets on the Sphere.
 -----------------------------------------------------------
 wav is cell array with all the wavelet coefficients.
 its first index is the wavelet scale j, the second
 index is the orientation g, and each element is a
 function on the sphere in MW sampling.
 scal is the corresponding scaling function contribution
 (i.e. just a single function on the sphere).
 B is the wavelet parameter.
 L is the angular band-limit.
 N is the orientational band-limit.
 J_min is the first wavelet scale in wav.

 Options consist of parameter type and value pairs.
 Valid options include:
  'Spin'            = { non-negative integers (default=0) }
  'Reality'         = { false        [do not assume f real (default)],
                        true         [assume f real (improves performance)] }
  'Upsample'        = { false        [multiresolution algorithm (default)],
                        true       [full resolution curvelets] }
  'SpinLowered'     = { true  [Apply normalisation factors for spin-lowered
                               curvelets and scaling function.],
                        false [Apply the usual normalisation factors such
                               that the curvelets fulfil the admissibility
                               condition (default)]}
  'SpinLoweredFrom' = [integer; if the SpinLowered option is used, this
                       option indicates which spin number the curvelets
                       should be lowered from (default = 0)]
  'Sampling'        = { 'MW'           [McEwen &amp; Wiaux sampling (default)],
                        'MWSS'         [McEwen &amp; Wiaux symmetric sampling] }


 FOR ssht_plot_mollweide(f, L, &lt;options&gt;)
 where f is the sampled function and L is the harmonic band-limit.
 Options consist of parameter type and value pairs.  Valid options
 include:
  'Method'          = { 'MW'         [McEwen &amp; Wiaux sampling (default)],
                        'MWSS'       [McEwen &amp; Wiaux symmetric sampling],
                        'DH'         [Driscoll &amp; Healy sampling],
                        'GL'         [Gauss-Legendre sampling] }
  'ColourBar'       = { false        [do not add colour bar (default)],
                        true         [add colour bar] }
  'Mode'            = { 0            Plot amplitude, or modulus is f complex (default),
                        1            Plot real part,
                        2            Plot imaginaty part,
                        3            Plot modulus and arrows for real/img angle }
  'Spin'            = { non-negative integers (default=0) }
 -----------------------------------------------------------
 Log: 
 -  constructed by Jennifer Y H Chan on 5th June 2015  
 -----------------------------------------------------------
 S2LET package to perform wavelet transform on the Sphere.
 Copyright (C) 2012  Boris Leistedt &amp; Jason McEwen
 See LICENSE.txt for license details
 -----------------------------------------------------------</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="s2let_bandlimit.html" class="code" title="function bl = s2let_bandlimit(j, J_min, B, L)">s2let_bandlimit</a>	s2let_bandlimit</li><li><a href="s2let_jmax.html" class="code" title="function J = s2let_jmax(L, B)">s2let_jmax</a>	s2let_jmax</li><li><a href="s2let_transform_spin_curvelet_analysis_px2cur.html" class="code" title="function [f_cur, f_scal] = s2let_transform_spin_curvelet_analysis_px2cur(f_init, varargin)">s2let_transform_spin_curvelet_analysis_px2cur</a>	s2let_transform_spin_curvelet_analysis_lm2cur</li><li><a href="s2let_transform_spin_curvelet_synthesis_cur2px.html" class="code" title="function f_rec = s2let_transform_spin_curvelet_synthesis_cur2px(f_cur, f_scal,  varargin)">s2let_transform_spin_curvelet_synthesis_cur2px</a>	s2let_transform_spin_curvelet_synthesis_lm2cur</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% s2let_demo9_Spin_Curvelet_Mollweide_EarthTomography</span>
0002 <span class="comment">% -----------------------------------------------------------</span>
0003 <span class="comment">% Plot curvelet coefficients on multiple Mollweide projections.</span>
0004 <span class="comment">% The function generates one plot of the scaling function</span>
0005 <span class="comment">% contribution and a grid of plots for each orientation of</span>
0006 <span class="comment">% each scale of the wavelet contributions.</span>
0007 <span class="comment">% -----------------------------------------------------------</span>
0008 <span class="comment">% S2LET package to perform Wavelets on the Sphere.</span>
0009 <span class="comment">% Copyright (C) 2012  Boris Leistedt &amp; Jason McEwen</span>
0010 <span class="comment">% See LICENSE.txt for license details</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% Modified S2LET package to perform Curvelets on the Sphere.</span>
0013 <span class="comment">% -----------------------------------------------------------</span>
0014 <span class="comment">% wav is cell array with all the wavelet coefficients.</span>
0015 <span class="comment">% its first index is the wavelet scale j, the second</span>
0016 <span class="comment">% index is the orientation g, and each element is a</span>
0017 <span class="comment">% function on the sphere in MW sampling.</span>
0018 <span class="comment">% scal is the corresponding scaling function contribution</span>
0019 <span class="comment">% (i.e. just a single function on the sphere).</span>
0020 <span class="comment">% B is the wavelet parameter.</span>
0021 <span class="comment">% L is the angular band-limit.</span>
0022 <span class="comment">% N is the orientational band-limit.</span>
0023 <span class="comment">% J_min is the first wavelet scale in wav.</span>
0024 <span class="comment">%</span>
0025 <span class="comment">% Options consist of parameter type and value pairs.</span>
0026 <span class="comment">% Valid options include:</span>
0027 <span class="comment">%  'Spin'            = { non-negative integers (default=0) }</span>
0028 <span class="comment">%  'Reality'         = { false        [do not assume f real (default)],</span>
0029 <span class="comment">%                        true         [assume f real (improves performance)] }</span>
0030 <span class="comment">%  'Upsample'        = { false        [multiresolution algorithm (default)],</span>
0031 <span class="comment">%                        true       [full resolution curvelets] }</span>
0032 <span class="comment">%  'SpinLowered'     = { true  [Apply normalisation factors for spin-lowered</span>
0033 <span class="comment">%                               curvelets and scaling function.],</span>
0034 <span class="comment">%                        false [Apply the usual normalisation factors such</span>
0035 <span class="comment">%                               that the curvelets fulfil the admissibility</span>
0036 <span class="comment">%                               condition (default)]}</span>
0037 <span class="comment">%  'SpinLoweredFrom' = [integer; if the SpinLowered option is used, this</span>
0038 <span class="comment">%                       option indicates which spin number the curvelets</span>
0039 <span class="comment">%                       should be lowered from (default = 0)]</span>
0040 <span class="comment">%  'Sampling'        = { 'MW'           [McEwen &amp; Wiaux sampling (default)],</span>
0041 <span class="comment">%                        'MWSS'         [McEwen &amp; Wiaux symmetric sampling] }</span>
0042 <span class="comment">%</span>
0043 <span class="comment">%</span>
0044 <span class="comment">% FOR ssht_plot_mollweide(f, L, &lt;options&gt;)</span>
0045 <span class="comment">% where f is the sampled function and L is the harmonic band-limit.</span>
0046 <span class="comment">% Options consist of parameter type and value pairs.  Valid options</span>
0047 <span class="comment">% include:</span>
0048 <span class="comment">%  'Method'          = { 'MW'         [McEwen &amp; Wiaux sampling (default)],</span>
0049 <span class="comment">%                        'MWSS'       [McEwen &amp; Wiaux symmetric sampling],</span>
0050 <span class="comment">%                        'DH'         [Driscoll &amp; Healy sampling],</span>
0051 <span class="comment">%                        'GL'         [Gauss-Legendre sampling] }</span>
0052 <span class="comment">%  'ColourBar'       = { false        [do not add colour bar (default)],</span>
0053 <span class="comment">%                        true         [add colour bar] }</span>
0054 <span class="comment">%  'Mode'            = { 0            Plot amplitude, or modulus is f complex (default),</span>
0055 <span class="comment">%                        1            Plot real part,</span>
0056 <span class="comment">%                        2            Plot imaginaty part,</span>
0057 <span class="comment">%                        3            Plot modulus and arrows for real/img angle }</span>
0058 <span class="comment">%  'Spin'            = { non-negative integers (default=0) }</span>
0059 <span class="comment">% -----------------------------------------------------------</span>
0060 <span class="comment">% Log:</span>
0061 <span class="comment">% -  constructed by Jennifer Y H Chan on 5th June 2015</span>
0062 <span class="comment">% -----------------------------------------------------------</span>
0063 <span class="comment">% S2LET package to perform wavelet transform on the Sphere.</span>
0064 <span class="comment">% Copyright (C) 2012  Boris Leistedt &amp; Jason McEwen</span>
0065 <span class="comment">% See LICENSE.txt for license details</span>
0066 <span class="comment">% -----------------------------------------------------------</span>
0067 
0068 clear all;
0069 close all ;
0070 
0071 load(<span class="string">'EGM2008_Topography_flms_L0128'</span>);
0072 L = 32;   <span class="comment">% To see the multi-resoluition effect i.e. Upsample = false, L &gt;=64)</span>
0073 flm_gen = flm(1:L^2,1);
0074 Spin = 0; 
0075 f_gen = ssht_inverse(flm_gen, L, <span class="string">'Spin'</span>, Spin, <span class="string">'Reality'</span>, false);
0076 
0077 
0078 <span class="comment">% ---------------</span>
0079 <span class="comment">% Define curvelet parameters:</span>
0080 <span class="comment">% ---------------</span>
0081 Spin = 0;
0082 B = 6;   
0083 N= L;     <span class="comment">% Since m=l, the azimuthal band limit N = overall band limit L</span>
0084 J_min = 1; <span class="comment">% minimum and maximum scale probed by wavelets</span>
0085 J =<a href="s2let_jmax.html" class="code" title="function J = s2let_jmax(L, B)">s2let_jmax</a>(L, B);  <span class="comment">%=ceil(log L/ log B);</span>
0086 
0087 <span class="comment">% ---------------</span>
0088 <span class="comment">% Define Plotting  parameters:</span>
0089 <span class="comment">% ---------------</span>
0090 zoomfactor =1.1;  <span class="comment">%1.6;</span>
0091 ns = ceil(sqrt(2+J-J_min+1)) ;
0092 ny = 16;  <span class="comment">%4 % ns - 1 + rem(2+J-J_min+1 , ns) ;</span>
0093 nx = 4;   <span class="comment">%3 % ns;</span>
0094 
0095 maxfigs = nx*ny;
0096 pltroot = <span class="string">'../../../figs'</span> ; 
0097 configstr = [<span class="string">'N'</span>,int2str(N),<span class="string">'_L'</span>,int2str(L),<span class="string">'_B'</span>,int2str(B),<span class="string">'_Jmin'</span>,int2str(J_min)]; 
0098 
0099 <span class="comment">% ================================================</span>
0100 <span class="comment">% FULL RESOLUTION PLOT (Upsample: true)</span>
0101 <span class="comment">% ================================================</span>
0102 <span class="comment">% Signal analysis:</span>
0103 <span class="comment">% -----------------</span>
0104 [f_cur, f_scal] = <a href="s2let_transform_spin_curvelet_analysis_px2cur.html" class="code" title="function [f_cur, f_scal] = s2let_transform_spin_curvelet_analysis_px2cur(f_init, varargin)">s2let_transform_spin_curvelet_analysis_px2cur</a>(f_gen,  <span class="keyword">...</span>
0105                                                   <span class="string">'B'</span>, B, <span class="string">'L'</span>, L, <span class="keyword">...</span>
0106                                                   <span class="string">'J_min'</span>, J_min, <span class="keyword">...</span>
0107                                                   <span class="string">'Spin'</span>, Spin, <span class="keyword">...</span>
0108                                                   <span class="string">'Reality'</span>, false, <span class="keyword">...</span>
0109                                                   <span class="string">'Upsample'</span>, true, <span class="keyword">...</span>
0110                                                   <span class="string">'SpinLowered'</span>, false, <span class="keyword">...</span>
0111                                                   <span class="string">'SpinLoweredFrom'</span>, 0,<span class="keyword">...</span>
0112                                                   <span class="string">'Sampling'</span>, <span class="string">'MW'</span>);
0113                                               
0114 f_cur_new = cell(J+1-J_min, 2*N-1);  
0115 <span class="keyword">for</span> j = J_min:J 
0116    <span class="keyword">for</span> en = 1: 2*N-1 
0117    f_cur_new{j-J_min+1, en} = reshape(f_cur{j-J_min+1}(en,:), L, 2*L-1);
0118    <span class="keyword">end</span>
0119 <span class="keyword">end</span>   
0120 <span class="comment">% figure</span>
0121 <span class="comment">% ssht_plot_mollweide(f_cur_new{1, 1}, L, 'Mode', 1);</span>
0122 
0123 
0124 figure(<span class="string">'Position'</span>,[20 20 1700 1400]) <span class="comment">%100 100 1300 1000</span>
0125 subplot(ny, nx, 1);
0126 <span class="comment">% --- plot initial data --- %</span>
0127 ssht_plot_mollweide(f_gen, L, <span class="string">'Mode'</span>, 1);
0128 <span class="comment">%</span>
0129 title(<span class="string">'Initial data'</span>)
0130 campos([0 0 -1]); camup([0 1 0]); zoom(zoomfactor)
0131 v = caxis;
0132 temp = max(abs(v));
0133 caxis([-temp temp])
0134 <span class="comment">%</span>
0135 subplot(ny, nx, 2);
0136 <span class="comment">% --- plot scaling function contributions --- %</span>
0137 ssht_plot_mollweide(f_scal, L, <span class="string">'Mode'</span>, 1);
0138 <span class="comment">%</span>
0139 title(<span class="string">'Scaling fct'</span>)
0140 campos([0 0 -1]); camup([0 1 0]); zoom(zoomfactor)
0141 v = caxis;
0142 temp = max(abs(v));
0143 caxis([-temp temp])
0144 <span class="comment">% --- plot curvelet kernel contributions --- %</span>
0145 ind = 2;
0146 <span class="keyword">for</span> j = J_min:J
0147     <span class="keyword">for</span> en = 1: 2*N-1 <span class="comment">%N</span>
0148         ind = ind + 1;
0149         <span class="keyword">if</span> ind &lt;= maxfigs
0150             subplot(ny, nx, ind);
0151             <span class="comment">%</span>
0152             ssht_plot_mollweide(f_cur_new{j-J_min+1, en}, L, <span class="string">'Mode'</span>, 1);
0153             <span class="comment">%</span>
0154             campos([0 0 -1]); camup([0 1 0]); zoom(zoomfactor)
0155             v = caxis;
0156             temp = max(abs(v));
0157             caxis([-temp temp])
0158             title([<span class="string">'Curvelet scale j='</span>,int2str(j)-J_min+1,<span class="string">', n='</span>,int2str(en)],<span class="string">'FontSize'</span>, 10)
0159         <span class="keyword">end</span>
0160     <span class="keyword">end</span>
0161 <span class="keyword">end</span>
0162 colormap(jet)
0163 fname = [pltroot,<span class="string">'/s2let_demo9_'</span>, configstr, <span class="string">'_spin_curvelet_EarthTomo_fullres.png'</span>]
0164 print(<span class="string">'-r200'</span>, <span class="string">'-dpng'</span>, fname)
0165 
0166 
0167 <span class="comment">% ----------</span>
0168 <span class="comment">% Compare reconstructed signal with the initial signals:</span>
0169 <span class="comment">% ----------</span>
0170 f_rec = <a href="s2let_transform_spin_curvelet_synthesis_cur2px.html" class="code" title="function f_rec = s2let_transform_spin_curvelet_synthesis_cur2px(f_cur, f_scal,  varargin)">s2let_transform_spin_curvelet_synthesis_cur2px</a>(f_cur, f_scal, <span class="keyword">...</span>
0171                                                   <span class="string">'B'</span>, B, <span class="string">'L'</span>, L, <span class="keyword">...</span>
0172                                                   <span class="string">'J_min'</span>, J_min, <span class="keyword">...</span>
0173                                                   <span class="string">'Spin'</span>, Spin, <span class="keyword">...</span>
0174                                                   <span class="string">'Reality'</span>, false, <span class="keyword">...</span>
0175                                                   <span class="string">'Upsample'</span>, true, <span class="keyword">...</span>
0176                                                   <span class="string">'SpinLowered'</span>, false, <span class="keyword">...</span>
0177                                                   <span class="string">'SpinLoweredFrom'</span>, 0,<span class="keyword">...</span>
0178                                                   <span class="string">'Sampling'</span>, <span class="string">'MW'</span>);
0179 
0180 figure(<span class="string">'Position'</span>,[100 100 900 200]) 
0181 subplot(2, 2, 1);
0182 ssht_plot_mollweide(f_gen, L, <span class="string">'Mode'</span>, 1);
0183 title(<span class="string">'initial signal'</span>)
0184 hold on
0185 subplot(2, 2, 2);
0186 ssht_plot_mollweide(f_rec,L, <span class="string">'Mode'</span>, 1);
0187 title(<span class="string">'reconstructed signal'</span>)
0188 fname = [pltroot,<span class="string">'/s2let_demo9_'</span>, configstr, <span class="string">'_spin_curvelet_EarthTomo_Fullres_Int_Rec_signal.png'</span>]
0189 print(<span class="string">'-r200'</span>, <span class="string">'-dpng'</span>, fname)
0190 <span class="comment">% Check error:</span>
0191 check_error = max(abs(f_gen(:)-f_rec(:)))
0192                            
0193 
0194 <span class="comment">% ================================================</span>
0195 <span class="comment">% MULTI-RESOLUTION PLOT (Upsample: false)</span>
0196 <span class="comment">% ================================================</span>
0197 [f_cur, f_scal] = <a href="s2let_transform_spin_curvelet_analysis_px2cur.html" class="code" title="function [f_cur, f_scal] = s2let_transform_spin_curvelet_analysis_px2cur(f_init, varargin)">s2let_transform_spin_curvelet_analysis_px2cur</a>(f_gen,  <span class="keyword">...</span>
0198                                                   <span class="string">'B'</span>, B, <span class="string">'L'</span>, L, <span class="keyword">...</span>
0199                                                   <span class="string">'J_min'</span>, J_min, <span class="keyword">...</span>
0200                                                   <span class="string">'Spin'</span>, Spin, <span class="keyword">...</span>
0201                                                   <span class="string">'Reality'</span>, false, <span class="keyword">...</span>
0202                                                   <span class="string">'Upsample'</span>, false, <span class="keyword">...</span>
0203                                                   <span class="string">'SpinLowered'</span>, false, <span class="keyword">...</span>
0204                                                   <span class="string">'SpinLoweredFrom'</span>, 0,<span class="keyword">...</span>
0205                                                   <span class="string">'Sampling'</span>, <span class="string">'MW'</span>);  
0206 
0207                                               
0208 figure(<span class="string">'Position'</span>,[20 20 1700 1400]) <span class="comment">%100 100 1300 1000</span>
0209 subplot(ny, nx, 1);
0210 <span class="comment">% --- plot initial data --- %</span>
0211 ssht_plot_mollweide(f_gen, L, <span class="string">'Mode'</span>, 1);
0212 <span class="comment">%</span>
0213 title(<span class="string">'Initial data'</span>)
0214 campos([0 0 -1]); camup([0 1 0]); zoom(zoomfactor)
0215 v = caxis;
0216 temp = max(abs(v));
0217 caxis([-temp temp])
0218 <span class="comment">%</span>
0219 subplot(ny, nx, 2);
0220 <span class="comment">% --- plot scaling function contributions --- %</span>
0221 bl = min([ <a href="s2let_bandlimit.html" class="code" title="function bl = s2let_bandlimit(j, J_min, B, L)">s2let_bandlimit</a>(J_min-1,J_min,B,L) L ]);
0222 ssht_plot_mollweide(f_scal, bl, <span class="string">'Mode'</span>, 1);
0223 <span class="comment">%</span>
0224 title(<span class="string">'Scaling fct'</span>)
0225 campos([0 0 -1]); camup([0 1 0]); zoom(zoomfactor)
0226 v = caxis;
0227 temp = max(abs(v));
0228 caxis([-temp temp])
0229 <span class="comment">% --- plot curvelet kernel contributions --- %</span>
0230 ind = 2;
0231 <span class="keyword">for</span> j = J_min:J
0232     <span class="keyword">for</span> en = 1: 2*N-1 <span class="comment">%N</span>
0233         ind = ind + 1;
0234         <span class="keyword">if</span> ind &lt;= maxfigs
0235             subplot(ny, nx, ind);
0236             <span class="comment">%</span>
0237             bl =  min([ <a href="s2let_bandlimit.html" class="code" title="function bl = s2let_bandlimit(j, J_min, B, L)">s2let_bandlimit</a>(j,J_min,B,L) L ]);
0238             ssht_plot_mollweide(reshape(f_cur{j-J_min+1}(en,:), bl, 2*bl-1), bl, <span class="string">'Mode'</span>, 1);
0239             <span class="comment">%</span>
0240             campos([0 0 -1]); camup([0 1 0]); zoom(zoomfactor)
0241             v = caxis;
0242             temp = max(abs(v));
0243             caxis([-temp temp])
0244             title([<span class="string">'Curvelet scale j='</span>,int2str(j)-J_min+1,<span class="string">', n='</span>,int2str(en)], <span class="string">'FontSize'</span>, 10)
0245         <span class="keyword">end</span>
0246     <span class="keyword">end</span>
0247 <span class="keyword">end</span>
0248 colormap(jet)
0249 fname = [pltroot,<span class="string">'/s2let_demo9_'</span>, configstr, <span class="string">'_spin_curvelet_EarthTomo_multires.png'</span>]
0250 print(<span class="string">'-r200'</span>, <span class="string">'-dpng'</span>, fname)
0251 
0252 
0253 <span class="comment">% ----------</span>
0254 <span class="comment">% Compare reconstructed signal with the initial signals:</span>
0255 <span class="comment">% ----------</span>
0256 f_rec = <a href="s2let_transform_spin_curvelet_synthesis_cur2px.html" class="code" title="function f_rec = s2let_transform_spin_curvelet_synthesis_cur2px(f_cur, f_scal,  varargin)">s2let_transform_spin_curvelet_synthesis_cur2px</a>(f_cur, f_scal, <span class="keyword">...</span>
0257                                                        <span class="string">'B'</span>, B, <span class="string">'L'</span>, L, <span class="keyword">...</span>
0258                                                        <span class="string">'J_min'</span>, J_min, <span class="keyword">...</span>
0259                                                        <span class="string">'Spin'</span>, Spin, <span class="keyword">...</span>
0260                                                        <span class="string">'Reality'</span>, false, <span class="keyword">...</span>
0261                                                        <span class="string">'Upsample'</span>, false, <span class="keyword">...</span>
0262                                                        <span class="string">'SpinLowered'</span>, false, <span class="keyword">...</span>
0263                                                        <span class="string">'SpinLoweredFrom'</span>, 0,<span class="keyword">...</span>
0264                                                        <span class="string">'Sampling'</span>, <span class="string">'MW'</span>);
0265 
0266 figure(<span class="string">'Position'</span>,[100 100 900 200]) 
0267 subplot(2, 2, 1);
0268 ssht_plot_mollweide(f_gen,L, <span class="string">'Mode'</span>, 1);
0269 title(<span class="string">'initial signal'</span>)
0270 hold on
0271 subplot(2, 2, 2);
0272 ssht_plot_mollweide(f_rec,L, <span class="string">'Mode'</span>, 1);
0273 title(<span class="string">'reconstructed signal'</span>)
0274 <span class="comment">% Check error:</span>
0275 check_error = max(abs(f_gen(:)-f_rec(:)))
0276                            
0277 fname = [pltroot,<span class="string">'/s2let_demo9_'</span>, configstr, <span class="string">'_spin_curvelet_EarthTomo_multires_Int_Rec_signal.png'</span>]
0278 print(<span class="string">'-r200'</span>, <span class="string">'-dpng'</span>, fname)
0279</pre></div>
<hr><address>Generated on Tue 16-Jun-2015 21:37:37 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>